<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AriaCoda: dataLoggerExample.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AriaCoda
   &#160;<span id="projectnumber">cdf8a12_2021-05-11</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dataLoggerExample_8cpp-example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">dataLoggerExample.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>Show how to register data values with the ArDataLogger object. The ArDataLogger will obtain a new set of values from functions or pointers you provide (with the return or variable type specified via template parameter) at a regular interval, format the value as text, and write it to a CSV, TSV or fixed-with text file row with a timestamp. <br  />
 ArDataLogger also contains various built-in robot-related values by default. <br  />
</p>
<p>ArDataLogger will always append new data to the log file, rather than rewriting it. If configuration changes or logging is re-enabled after being disabled, a new header row is written to the file.</p>
<p>All logging, and whether to log individual data values, can be enabled or disabled in program configuration (via ArConfig), and the file name, file type, and interval can be configured. When used in an ArNetworking server, users can use a client such as MobileEyes to modify this configuration. This example program will use a configuration file called dataLoggerExample.cfg if present. If not present, a new config file with defaults will be created. Edit this file to enable logging and enable individual values to log, and re-run the program.</p>
<p>An ArNetworkingServer can also register these same values with the StringInfo feature for display in MobileEyes or other clients. Configuration can also be changed by users via ArNetworking, and some extra commands can be added such as clearing or saving a copy of the data log. See the ArNetworking examples (and ARNL or MOGS examples, if you have ARNL or MOGS). See the detailed documentation of the ArDataLogger class in the ARIA API reference documenttation for more details including which data types are supported.</p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">Adept MobileRobots Robotics Interface for Applications (ARIA)</span></div>
<div class="line"><span class="comment">Copyright (C) 2004-2005 ActivMedia Robotics LLC</span></div>
<div class="line"><span class="comment">Copyright (C) 2006-2010 MobileRobots Inc.</span></div>
<div class="line"><span class="comment">Copyright (C) 2011-2015 Adept Technology, Inc.</span></div>
<div class="line"><span class="comment">Copyright (C) 2016-2018 Omron Adept Technologies, Inc.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">     This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment">     it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><span class="comment">     the Free Software Foundation; either version 2 of the License, or</span></div>
<div class="line"><span class="comment">     (at your option) any later version.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">     This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">     but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment">     GNU General Public License for more details.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">     You should have received a copy of the GNU General Public License</span></div>
<div class="line"><span class="comment">     along with this program; if not, write to the Free Software</span></div>
<div class="line"><span class="comment">     Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;Aria/Aria.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Aria/ariaUtil.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Aria/ArDataLogger.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* An example function that returns an int */</span></div>
<div class="line"><span class="keywordtype">int</span> i = 0;</div>
<div class="line"><span class="keywordtype">int</span> getExampleInt() { </div>
<div class="line">  <span class="keywordflow">if</span>(i &gt;= 99999) i = 0;</div>
<div class="line">  <span class="keywordflow">return</span> i++;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* An example function that returns a float */</span></div>
<div class="line"><span class="keywordtype">float</span> f = 2;</div>
<div class="line"><span class="keywordtype">float</span> getExampleFloat() {</div>
<div class="line">  <span class="keywordflow">if</span>(f &gt; 99999) f = 0;</div>
<div class="line">  f *= 2;</div>
<div class="line">  <span class="keywordflow">return</span> f;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* An example function that returns an ArPose object. */</span></div>
<div class="line">ArPose p;</div>
<div class="line">ArPose getExamplePose() {</div>
<div class="line">  <span class="keywordflow">return</span> p;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">/* You can get values from object methods as well */</span></div>
<div class="line"><span class="keyword">class </span>ExampleClass {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keywordtype">long</span> getRandomNumber() {</div>
<div class="line">    <span class="keywordflow">return</span> ArMath::randomInRange(0, 100);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">  Aria::init();</div>
<div class="line">  ArArgumentParser argparser(&amp;argc, argv);</div>
<div class="line">  argparser.loadDefaultArguments();</div>
<div class="line">  ArRobot robot;</div>
<div class="line"> </div>
<div class="line">  ArDataLogger dataLogger(&amp;robot, <span class="stringliteral">&quot;dataLoggerExample.log&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Make it configurable via config  file or MobileEyes: </span></div>
<div class="line">  <span class="comment">// To Use config file, you must get ArConfig via</span></div>
<div class="line">  <span class="comment">// Aria::getConfig() and load the file.  To use a config file and also be</span></div>
<div class="line">  <span class="comment">// configurable remotely via MobileEyes, also use ArServerHandlerConfig. See</span></div>
<div class="line">  <span class="comment">// ArNetworking examples and documentation.</span></div>
<div class="line">  dataLogger.addToConfig(Aria::getConfig()); </div>
<div class="line"> </div>
<div class="line">  dataLogger.addData&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;Example Int&quot;</span>, <span class="keyword">new</span> ArGlobalRetFunctor&lt;int&gt;(&amp;getExampleInt), <span class="stringliteral">&quot;%d&quot;</span>);</div>
<div class="line">  dataLogger.addData&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;Example Float&quot;</span>, <span class="keyword">new</span> ArGlobalRetFunctor&lt;float&gt;(&amp;getExampleFloat), <span class="stringliteral">&quot;%f&quot;</span>);</div>
<div class="line">  dataLogger.addData&lt;ArPose&gt;(<span class="stringliteral">&quot;Example Pose&quot;</span>, <span class="keyword">new</span> ArGlobalRetFunctor&lt;ArPose&gt;(&amp;getExamplePose), <span class="stringliteral">&quot;(%f %f %f)&quot;</span>);</div>
<div class="line">  ExampleClass exampleObj;</div>
<div class="line">  dataLogger.addData&lt;<span class="keywordtype">long</span>&gt;(<span class="stringliteral">&quot;Example Random Number&quot;</span>, <span class="keyword">new</span> ArRetFunctorC&lt;long, ExampleClass&gt;(&amp;exampleObj, &amp;ExampleClass::getRandomNumber), <span class="stringliteral">&quot;%ld&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  ArRobotConnector robotConnector(&amp;argparser, &amp;robot);</div>
<div class="line">  <span class="keywordflow">if</span>(!robotConnector.connectRobot())</div>
<div class="line">  {</div>
<div class="line">    ArLog::log(ArLog::Terse, <span class="stringliteral">&quot;dataLoggerExample: Could not connect to the robot.&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span>(argparser.checkHelpAndWarnUnparsed())</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// -help not given</span></div>
<div class="line">        Aria::logOptions();</div>
<div class="line">        Aria::exit(1);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!Aria::parseArgs() || !argparser.checkHelpAndWarnUnparsed())</div>
<div class="line">  {</div>
<div class="line">    Aria::logOptions();</div>
<div class="line">    Aria::exit(1);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  ArLog::log(ArLog::Normal, <span class="stringliteral">&quot;dataLoggerExample: Connected to robot.&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// todo move this into a utility function:</span></div>
<div class="line">  Aria::getConfig()-&gt;setBaseDirectory(<span class="stringliteral">&quot;./&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span>(Aria::getConfig()-&gt;parseFile(<span class="stringliteral">&quot;dataLoggerExample.cfg&quot;</span>, <span class="keyword">true</span>, <span class="keyword">true</span>))</div>
<div class="line">  {</div>
<div class="line">    ArLog::log(ArLog::Normal, <span class="stringliteral">&quot;dataLoggerExample: Loaded config file dataLoggerExample.cfg&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span>(ArUtil::findFile(<span class="stringliteral">&quot;dataLoggerExample.cfg&quot;</span>))</div>
<div class="line">    {</div>
<div class="line">      ArLog::log(ArLog::Terse, <span class="stringliteral">&quot;dataLoggerExample: Warning: Error loading config file dataLoggerExample.cfg.&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">      ArLog::log(ArLog::Normal, <span class="stringliteral">&quot;dataLoggerExample: Creating new config file dataLoggerExample.cfg&quot;</span>);</div>
<div class="line">      Aria::getConfig()-&gt;writeFile(<span class="stringliteral">&quot;dataLoggerExample.cfg&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Logging can be enabled/disabled in the configuration.  Or we can always</span></div>
<div class="line">  <span class="comment">// start logging by calling startLogging:</span></div>
<div class="line">  dataLogger.startLogging();</div>
<div class="line">  ArLog::log(ArLog::Normal, <span class="stringliteral">&quot;dataLoggerExample: Starting data logging to %s at %d sec interval&quot;</span>, dataLogger.getLogFileName(), dataLogger.getLogInterval());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Start the robot processing cycle running in the background.</span></div>
<div class="line">  <span class="comment">// True parameter means that if the connection is lost, then the </span></div>
<div class="line">  <span class="comment">// run loop ends.  The robot cycle will trigger dataLogger.</span></div>
<div class="line">  robot.run(<span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  ArLog::log(ArLog::Normal, <span class="stringliteral">&quot;dataLoggerExample: Exiting.&quot;</span>);</div>
<div class="line">  Aria::exit(0);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
